# test name
name: security-policies

# list of policy files
policies:
  - ../../kyverno/base/disallow-latest-tag.yaml
  - ../../kyverno/base/disallow-privileged-hostpath.yaml

# list of resource files
resources:
  - resources/bad-latest-pod.yaml
  - resources/good-pod.yaml
  - resources/bad-privileged-pod.yaml
  - resources/bad-hostpath-pod.yaml

# variables file (optional)
variables:

# list of expected results
results:
  - policy: disallow-latest-tag
    rule: no-latest-tag
    resource: good-pod
    namespace:
    kind: Pod
    result: pass
  - policy: disallow-privileged-hostpath
    rule: disallow-privileged
    resource: good-pod
    namespace:
    kind: Pod
    result: pass
  - policy: disallow-privileged-hostpath
    rule: disallow-hostpath
    resource: good-pod
    namespace:
    kind: Pod
    result: pass
  - policy: disallow-latest-tag
    rule: no-latest-tag
    resource: bad-latest
    namespace:
    kind: Pod
    result: fail
  - policy: disallow-privileged-hostpath
    rule: disallow-privileged
    resource: bad-privileged
    namespace:
    kind: Pod
    result: fail
  - policy: disallow-privileged-hostpath
    rule: disallow-hostpath
    resource: bad-hostpath
    namespace:
    kind: Pod
    result: fail
